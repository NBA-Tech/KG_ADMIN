<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0"
    />
    <meta name="description" content="Preskool - Bootstrap Admin Template" />
    <meta
      name="keywords"
      content="admin, estimates, bootstrap, business, html5, responsive, Projects"
    />
    <meta
      name="author"
      content="Dreams technologies - Bootstrap Admin Template"
    />
    <meta name="robots" content="noindex, nofollow" />
    <title>Preskool Admin Template</title>

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="assets/img/favicon.png"
    />

    <!-- Theme Script -->
    <script
      src="assets/js/theme-script.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />

    <!-- Feather CSS -->
    <link rel="stylesheet" href="assets/plugins/icons/feather/feather.css" />

    <!-- Tabler Icon CSS -->
    <link
      rel="stylesheet"
      href="assets/plugins/tabler-icons/tabler-icons.css"
    />

    <!-- Daterangepikcer CSS -->
    <link
      rel="stylesheet"
      href="assets/plugins/daterangepicker/daterangepicker.css"
    />

    <!-- Fontawesome CSS -->
    <link
      rel="stylesheet"
      href="assets/plugins/fontawesome/css/fontawesome.min.css"
    />
    <link rel="stylesheet" href="assets/plugins/fontawesome/css/all.min.css" />

    <!-- Select2 CSS -->
    <link rel="stylesheet" href="assets/plugins/select2/css/select2.min.css" />

    <!-- Datetimepicker CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap-datetimepicker.min.css" />

    <!-- Bootstrap Tagsinput CSS -->
    <link
      rel="stylesheet"
      href="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css"
    />

    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body>
    <!-- Main Wrapper -->
    <div class="main-wrapper">
      <!-- Header -->
      <%- include('header') %>
      <!-- /Header -->

      <!-- Sidebar -->
      <%- include('sidebar') %>
      <!-- /Sidebar -->

      <!-- Page Wrapper -->
      <div class="page-wrapper">
        <div class="content content-two">
          <!-- Page Header -->
          <div
            class="d-md-flex d-block align-items-center justify-content-between mb-3"
          >
            <div class="my-auto mb-2">
              <h3 class="mb-1">Add Event</h3>
        <nav>
          <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="events.html">Events</a></li>
            <li class="breadcrumb-item active" aria-current="page">Add Event</li>
          </ol>
        </nav>
            </div>
          </div>
          <!-- /Page Header -->

           <div class="row">
      <div class="col-md-12">
        <form action="events.html" id="eventForm">
          <div class="card">
            <div class="card-body pb-1">
              <div class="row row-cols-xxl-5 row-cols-md-6">

                <!-- Event Title -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Event Title</label>
                    <input type="text" name="event_title" class="form-control" placeholder="Eg: Annual Food Fest 2025" />
                  </div>
                </div>

                <!-- Event Type -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Event Type</label>
                    <select name="event_type" class="select form-select">
                      <option>Select</option>
                      <option>Food Fest</option>
                      <option>Science Fair</option>
                      <option>Cultural Program</option>
                      <option>Sports Day</option>
                      <option>Seminar</option>
                    </select>
                  </div>
                </div>

                <!-- Organizer Name -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Organizer</label>
                    <input type="text" name="organizer" class="form-control" placeholder="Eg: Science Club" />
                  </div>
                </div>

                <!-- Event Date -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Event Date</label>
                    <input type="date" name="event_date" class="form-control" />
                  </div>
                </div>

                <!-- Event Status -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Status</label>
                    <select name="event_status" class="form-select">
                      <option>Draft</option>
                      <option>Upcoming</option>
                      <option>Completed</option>
                      <option>Cancelled</option>
                    </select>
                  </div>
                </div>

              </div>

              <div class="row">
                <!-- Description -->
                <div class="col-md-12">
                  <div class="mb-3">
                    <label class="form-label">Event Description</label>
                    <textarea name="event_description" class="form-control" rows="3" placeholder="Describe the event"></textarea>
                  </div>
                </div>
              </div>

              <div class="row row-cols-xxl-4 row-cols-md-6">
                <!-- Start Time -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Start Time</label>
                    <input type="time" name="start_time" class="form-control" />
                  </div>
                </div>

                <!-- End Time -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">End Time</label>
                    <input type="time" name="end_time" class="form-control" />
                  </div>
                </div>

                <!-- Location -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Venue</label>
                    <input type="text" name="location" class="form-control" placeholder="Eg: Auditorium" />
                  </div>
                </div>

                <!-- Target Audience -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Target Audience</label>
                    <input type="text" name="audience" class="form-control" placeholder="Eg: Grade 10â€“12, Teachers" />
                  </div>
                </div>
              </div>

              <div class="row row-cols-xxl-4 row-cols-md-6">
                <!-- Registration Required -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label d-block">Registration Required?</label>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="registration_required" value="Yes" />
                      <label class="form-check-label">Yes</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="registration_required" value="No" />
                      <label class="form-check-label">No</label>
                    </div>
                  </div>
                </div>

                <!-- Registration Deadline -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Registration Deadline</label>
                    <input type="date" name="registration_deadline" class="form-control" />
                  </div>
                </div>

                <!-- Max Participants -->
                <div class="col">
                  <div class="mb-3">
                    <label class="form-label">Max Participants</label>
                    <input type="number" name="max_participants" class="form-control" placeholder="Eg: 100" />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Uploads -->
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <label class="form-label">Event Cover Image</label>
                  <input type="file" name="cover_image" class="form-control"  />
                  <small class="text-muted">Max size 4MB. JPG/PNG only.</small>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Poster / Banner</label>
                  <input type="file" name="poster_banner" class="form-control" />
                  <small class="text-muted">Max size 4MB. JPG/PDF only.</small>
                </div>

                <div class="col-md-6 mt-3">
                  <label class="form-label">Additional Attachments</label>
                  <input type="file" name="attachments" class="form-control" />
                  <small class="text-muted">Eg: Program Schedule, Rules (PDF)</small>
                </div>

                <div class="col-md-6 mt-3">
                  <label class="form-label">Event Media Gallery</label>
                  <input type="file" name="media_gallery[]" class="form-control" multiple />
                  <small class="text-muted">Upload photos/videos (optional)</small>
                </div>
              </div>
            </div>
          </div>

          <!-- Post-Event Section -->
          <div class="card">
            <div class="card-body pb-1">
              <div class="mb-3">
                <label class="form-label">Event Highlights (Post-Event)</label>
                <textarea name="event_highlights" class="form-control" rows="3" placeholder="Eg: 200+ students attended, 5 awards given"></textarea>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="text-end mt-3">
            <button type="button" class="btn btn-light me-3">Cancel</button>
            <button type="submit" class="btn btn-primary">Add Event</button>
          </div>

        </form>
      </div>
    </div>
        </div>
      </div>
      <!-- /Page Wrapper -->
    </div>
    <!-- /Main Wrapper -->

    <!-- jQuery -->
    <script
      src="assets/js/jquery-3.7.1.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Bootstrap Core JS -->
    <script
      src="assets/js/bootstrap.bundle.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Daterangepikcer JS -->
    <script
      src="assets/js/moment.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>
    <script
      src="assets/plugins/daterangepicker/daterangepicker.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Feather Icon JS -->
    <script
      src="assets/js/feather.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Slimscroll JS -->
    <script
      src="assets/js/jquery.slimscroll.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Select2 JS -->
    <script
      src="assets/plugins/select2/js/select2.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Datetimepicker JS -->
    <script
      src="assets/js/moment.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>
    <script
      src="assets/js/bootstrap-datetimepicker.min.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Bootstrap Tagsinput JS -->
    <script
      src="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <!-- Custom JS -->
    <script
      src="assets/js/script.js"
      type="6dc0a9d0ac43462e72fa7502-text/javascript"
    ></script>

    <script
      src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js"
      data-cf-settings="6dc0a9d0ac43462e72fa7502-|49"
      defer
    ></script>
    <script
      defer
      src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
      integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
      data-cf-beacon='{"rayId":"95d12b338917a908","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"3ca157e612a14eccbb30cf6db6691c29"}'
      crossorigin="anonymous"
    ></script>

    <script>
      const BACKEND_URL = "<%= BACKEND_URL %>";
      document
        .getElementById("add-student-btn")
        .addEventListener("click", async function (event) {
          event.preventDefault();
          // Here you can add your form submission logic
          const formElement = document.getElementById("studentForm");
          const formData = new FormData(formElement);

          // Convert FormData to a plain object
          const jsonObject = {};
          for (const [key, value] of formData.entries()) {
            jsonObject[key] = value instanceof File ? value.name : value;
          }

          console.log("Payload:", jsonObject);

          try {
            const response = await fetch(
              `${BACKEND_URL}/students/update_new_student`,
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(jsonObject),
              }
            );

            const data = await response.json();

            if (data?.success) {
              showToast(
                "success",
                data?.message || "Student added successfully."
              );
            } else {
              showToast("error", data?.message || "Failed to add student.");
            }
          } catch (error) {
            console.error("Error:", error);
            showToast(
              "error",
              "Something went wrong while adding the student."
            );
          }
        });
    </script>
    <script>
  document.getElementById("student_birth_certificate").addEventListener("change", function (event) {
    const file = event.target.files[0];

    if (file) {
      const maxSize = 4 * 1024 * 1024; // 4MB

      if (file.type !== "application/pdf") {
        alert("Only PDF files are allowed.");
        return;
      }

      if (file.size > maxSize) {
        alert("File size exceeds 4MB.");
        return;
      }

      const previewDiv = document.getElementById("student_birth_certificate_preview");
      previewDiv.innerHTML = `
        <div style="margin-top: 10px; display: flex; align-items: center; gap: 8px;">
          <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="PDF Icon" style="width: 24px; height: 24px;" />
          <span>${file.name}</span>
        </div>
      `;
    }
  });
</script>

    <script>
  document.getElementById("student_profile_photo").addEventListener("change", function (event) {
    const file = event.target.files[0];

    if (file) {
      const allowedTypes = ["image/jpeg", "image/png"];
      const maxSize = 4 * 1024 * 1024; // 4MB

      if (!allowedTypes.includes(file.type)) {
        alert("Only JPG or PNG files are allowed.");
        return;
      }

      if (file.size > maxSize) {
        alert("File size exceeds 4MB.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        const previewDiv = document.getElementById("student_profile_photo_preview");
        previewDiv.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 100%; height: auto; margin-top: 10px;" />`;
      };

      reader.readAsDataURL(file);
    }
  });
</script>

  </body>
</html>
